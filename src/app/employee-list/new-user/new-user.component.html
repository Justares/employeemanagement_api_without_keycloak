<div class="modal-overlay">
  <div class="modal-content">
    <h2>{{ mode === 'create' ? 'Create New User' : mode === 'view' ? 'User Details' : 'Edit User' }}</h2>
    <form #userForm="ngForm" (ngSubmit)="onSubmit(userForm)">
      <!-- Error message area -->
      <div *ngIf="errorMessage" class="error-message">
        {{ errorMessage }}
      </div>

      <div class="form-group">
        <label for="lastName">Last Name:</label>
        <input
          type="text"
          id="lastName"
          name="lastName"
          [(ngModel)]="newEmployee.lastName"
          required
          #lastName="ngModel"
          [class.is-invalid]="hasError(userForm, 'lastName')"
          [disabled]="isViewMode()">
        <div class="invalid-feedback" *ngIf="hasError(userForm, 'lastName')">
          Last Name is required
        </div>
      </div>

      <div class="form-group">
        <label for="firstName">First Name:</label>
        <input
          type="text"
          id="firstName"
          name="firstName"
          [(ngModel)]="newEmployee.firstName"
          required
          #firstName="ngModel"
          [class.is-invalid]="hasError(userForm, 'firstName')"
          [disabled]="isViewMode()">
        <div class="invalid-feedback" *ngIf="hasError(userForm, 'firstName')">
          First Name is required
        </div>
      </div>

      <div class="form-group">
        <label for="street">Street:</label>
        <input
          type="text"
          id="street"
          name="street"
          [(ngModel)]="newEmployee.street"
          required
          #street="ngModel"
          [class.is-invalid]="hasError(userForm, 'street')"
          [disabled]="isViewMode()">
        <div class="invalid-feedback" *ngIf="hasError(userForm, 'street')">
          Street is required
        </div>
      </div>

      <div class="form-group">
        <label for="postcode">Postcode:</label>
        <input
          type="text"
          id="postcode"
          name="postcode"
          [(ngModel)]="newEmployee.postcode"
          required
          pattern="[0-9]{5}"
          #postcode="ngModel"
          [class.is-invalid]="hasError(userForm, 'postcode')"
          [disabled]="isViewMode()">
        <div class="invalid-feedback" *ngIf="hasError(userForm, 'postcode')">
          Please enter a valid 5-digit postcode
        </div>
      </div>

      <div class="form-group">
        <label for="city">City:</label>
        <input
          type="text"
          id="city"
          name="city"
          [(ngModel)]="newEmployee.city"
          required
          #city="ngModel"
          [class.is-invalid]="hasError(userForm, 'city')"
          [disabled]="isViewMode()">
        <div class="invalid-feedback" *ngIf="hasError(userForm, 'city')">
          City is required
        </div>
      </div>

      <div class="form-group">
        <label for="phone">Phone:</label>
        <input
          type="tel"
          id="phone"
          name="phone"
          [(ngModel)]="newEmployee.phone"
          required
          pattern="[0-9]{11}"
          #phone="ngModel"
          [class.is-invalid]="hasError(userForm, 'phone')"
          [disabled]="isViewMode()">
        <div class="invalid-feedback" *ngIf="hasError(userForm, 'phone')">
          Please enter a valid 11-digit phone number
        </div>
      </div>

      <div class="form-group">
        <label for="skillSet">Skill Set:</label>
        <select
          id="skillSet"
          name="skillSet"
          [(ngModel)]="newEmployee.skillSet"
          multiple
          required
          #skillSet="ngModel"
          [class.is-invalid]="hasError(userForm, 'skillSet')"
          [disabled]="isViewMode()">
          <option *ngFor="let skill of availableSkills" [ngValue]="skill.id">
            {{skill.skill}}
          </option>
        </select>
        <div class="invalid-feedback" *ngIf="hasError(userForm, 'skillSet')">
          Please select at least one skill
        </div>
      </div>

      <div class="button-group">
        <button type="button" (click)="onCancel()" [disabled]="submitting">Cancel</button>
        <button *ngIf="mode !== 'view'" type="submit" [disabled]="submitting">
          {{submitting ? (mode === 'create' ? 'Creating...' : 'Updating...') : (mode === 'create' ? 'Create User' : 'Update User')}}
        </button>
      </div>
    </form>
  </div>
</div>
